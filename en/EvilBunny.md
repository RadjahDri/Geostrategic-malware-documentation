#  EvilBunny
---
## Contributor(s)
@Wellan129
@P0rtalis (translation)
## Last update
30/01/2017
---
## Appearance
### Date
25th of Octobre 2011
### Context
- Between 2006 and 2010 : Important recruitment and investment by the DGSE(France)
- Crash of Automn 2008

Why Ivory Coast ?
- In 2010, Abidjan is at the heart of an electoral battle between Alassane Ouatarra and Laurent Gbagbo.
- For Nicolas Sarkozy, the French president, only the victory of Ouatarra is acceptable. 
- 2nd of December, Alassane Ouatarra is declared winner of the election by the people and Choi Young-Jin.
- 4th of December, Laurent Gbagbo is declared winner of the election by the constitutionnal council. 
- These events are the trigger of a civil war.

Why Algeria : 
- Algeria is a prime regional actor for France, especially on security questions.
- End of 2009, Alger stops communicating with Paris.

Why Greece ?
- According to the CSEC, Greece is targeted for its links to the European Financial Association. 

Why Iran ?
- In July 2008, Iran decides non negociably to continue to enrich uranium. Attempts to negociate continues. 
- in September 2009, France, USA, and United Kingdom denounce Iran for constructing an Enrichement plant for Uranium.

### Propagation
Exploits is delivered throught malicious PDF(attached in emails).
## Impacts
### Purposes
The exploits downloads the droppper "bunny" which will deliver "suspect #4". Bunny will check for antivrus product on the infected system et if it is a sandbox. it also delivers "netmgr.exe" which is also known as "suspect #4". It will also create a registry key for persistence and another key to erase Bunny. The malware "suspect #4" is written in C++. It is a multi-threaded bot which includes a Lua interpreter. It allows the the download and execution of Lua scripts. These scripts can call the C++ code of the malware which will modify its behavior at the start of the system. The goal of the malware is to hide in the system while executing Lua Scripts and commands from a C&C server.
### Exploitation
Exploits CVE-2011-4369, which was a 0day at the time.
### Targets
#### Entities
Semblent être les mêmes cibles que Babar : Cibles principales : l’Organisation de l'énergie atomique d'Iran (AEO), l’université de Science et Technologie et deux écoles Tehran très impliquées dans la recherche nucléaire : Malek-E-Ashtar University of Technology and Imam Hussein University.

Autres cibles : Un média Canadien francophone. EvilBunny a aussi été utilisé pour espionner sur les Institutions financières Européennes et a été repéré dans les pays suivants en plus des deux cités précédemments : Espagne, Grèce, Norvège, Côte d’Ivoire et Algérie.
Seems to be the same targets as Babar. Its main targets are :
- the AEO (Atomic Energy Organisation of Iran)
- Universities of Teheran
    + Malek-E-Ashtar University of Technology
    + Imam Hussein University

Other targets : 
- French Canadian media
- European Financial Association
- Was seen in these countries :
    + Spain
    + Greece
    + Norway
    + Ivory Coast
    + Algeria
#### Systems
Windows
### Reaction
N/A
### Targeted countries
Iran, Spain, Canada, Greece, Norway, Ivory Coast, Algeria
### Damage caused and cost
N/A
## Origin
### Geographic
France
### Entities
DGSE is strongly suspected.
### Claim
N/A
## Obsolescence
### Date
The CVE was published the 16/12/2011
### Trigger
Pulication of the CVE triggered the development of security patches which limited the diffusion of EvilBunny
## Typology
Trojan
## Genealogy
### Parent
N/A
### Descendent
N/A
## Other features
"It seems that EvilBunny is an early version of Babar, which was then heavily modified."
## Chronology
- dd/mm/YYYY (TypeEvt) : Text
- 01/07/2008 (Political) : L'Iran décide de continuer à enrichir l'uranium et c'est un point non négociable. Cependant des tentatives de négociations continuent.
- 01/09/2009 (Political) : Les Etats-Unis et le Royaume-Uni accusent l'Iran de construire une usine d'enrichissement d'uranium.
- 01/11/2009 (Attack) : Début de l'opération (lancement de Babar).
- 01/12/2009 (Political) : Alger a rompu le dialogue avec Paris.
- 31/10/2010 (Political) : Abidjan est au coeur des batailles présidentielles.
- 02/12/2010 (Political) : Alassane Ouattara est proclamé vainqueur des élections par le peuple et par Choi Young-jin.
- 04/12/2010 (Political) : Laurent Gbagbo est proclamé vainqueur par le Conseil Constitutionnel.
- 07/12/2010 (Political) : Début d'une guerre civile en côte d'ivoire.


## Sources
[https://drive.google.com/file/d/0B9Mrr-en8FX4M2lXN1B4eElHcE0/view](https://drive.google.com/file/d/0B9Mrr-en8FX4M2lXN1B4eElHcE0/view)
[http://www.lemonde.fr/pixels/article/2015/02/18/le-programme-espion-babar-a-un-grand-frere-evil-bunny_4575799_4408996.html](http://www.lemonde.fr/pixels/article/2015/02/18/le-programme-espion-babar-a-un-grand-frere-evil-bunny_4575799_4408996.html)
[https://www.cyphort.com/evilbunny-malware-instrumented-lua/](https://www.cyphort.com/evilbunny-malware-instrumented-lua/)
[http://www.slideshare.net/pinkflawd/tsnoforn](http://www.slideshare.net/pinkflawd/tsnoforn)
